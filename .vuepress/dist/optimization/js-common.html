<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>思维发散 | js优化总结</title>
    <meta name="description" content="努力前行,温故而知新">
    <meta httpEquiv="pragma" content="no-cache">
  <meta httpEquiv="Cache-Control" content="no-cache">
  <meta name="keywords" content="前端基础,前端进阶,思维导图,javascript,react,vue">
  <link rel="icon" href="/favicon.ico">
    
    <link rel="preload" href="/assets/css/185.styles.15a58fe7.css" as="style"><link rel="preload" href="/assets/js/app.6f74513f.js" as="script"><link rel="preload" href="/assets/js/79.a472ce98.js" as="script"><link rel="prefetch" href="/assets/js/85.7dba617a.js"><link rel="prefetch" href="/assets/js/0.de4c5cb9.js"><link rel="prefetch" href="/assets/js/1.aafd88fb.js"><link rel="prefetch" href="/assets/js/2.e18c1574.js"><link rel="prefetch" href="/assets/js/3.a212f098.js"><link rel="prefetch" href="/assets/js/4.7fee04f2.js"><link rel="prefetch" href="/assets/js/5.f126e8e6.js"><link rel="prefetch" href="/assets/js/6.865c06f4.js"><link rel="prefetch" href="/assets/js/7.d230886e.js"><link rel="prefetch" href="/assets/js/8.fbba557d.js"><link rel="prefetch" href="/assets/js/9.d9950a97.js"><link rel="prefetch" href="/assets/js/10.d391b1ae.js"><link rel="prefetch" href="/assets/js/11.f53ea787.js"><link rel="prefetch" href="/assets/js/12.8876c6c2.js"><link rel="prefetch" href="/assets/js/13.768076b6.js"><link rel="prefetch" href="/assets/js/14.86bc2a8d.js"><link rel="prefetch" href="/assets/js/15.84f0efd4.js"><link rel="prefetch" href="/assets/js/16.a55422a0.js"><link rel="prefetch" href="/assets/js/17.ee994af8.js"><link rel="prefetch" href="/assets/js/18.51fc2dae.js"><link rel="prefetch" href="/assets/js/19.25bb4403.js"><link rel="prefetch" href="/assets/js/20.8bf0bd81.js"><link rel="prefetch" href="/assets/js/21.e34bbb46.js"><link rel="prefetch" href="/assets/js/22.e0134651.js"><link rel="prefetch" href="/assets/js/23.ec3b488b.js"><link rel="prefetch" href="/assets/js/24.a3be8f2d.js"><link rel="prefetch" href="/assets/js/25.84836d2d.js"><link rel="prefetch" href="/assets/js/26.f796c414.js"><link rel="prefetch" href="/assets/js/27.36ef3e5b.js"><link rel="prefetch" href="/assets/js/28.fc529d56.js"><link rel="prefetch" href="/assets/js/29.e44a49ca.js"><link rel="prefetch" href="/assets/js/30.c98a771b.js"><link rel="prefetch" href="/assets/js/31.f2b58b01.js"><link rel="prefetch" href="/assets/js/32.cbd7e22f.js"><link rel="prefetch" href="/assets/js/33.9eec936a.js"><link rel="prefetch" href="/assets/js/34.a312b1a9.js"><link rel="prefetch" href="/assets/js/35.2c1be0f5.js"><link rel="prefetch" href="/assets/js/36.34302d24.js"><link rel="prefetch" href="/assets/js/37.5ec7c03b.js"><link rel="prefetch" href="/assets/js/38.de01b28d.js"><link rel="prefetch" href="/assets/js/39.d95168b8.js"><link rel="prefetch" href="/assets/js/40.8d0d23b5.js"><link rel="prefetch" href="/assets/js/41.6246ed59.js"><link rel="prefetch" href="/assets/js/42.94cbe7bc.js"><link rel="prefetch" href="/assets/js/43.20ce9965.js"><link rel="prefetch" href="/assets/js/44.ccadc0c7.js"><link rel="prefetch" href="/assets/js/45.9083f405.js"><link rel="prefetch" href="/assets/js/46.dca499a4.js"><link rel="prefetch" href="/assets/js/47.6ac72fe6.js"><link rel="prefetch" href="/assets/js/48.e074c7a0.js"><link rel="prefetch" href="/assets/js/49.2739bb01.js"><link rel="prefetch" href="/assets/js/50.0d06e9c0.js"><link rel="prefetch" href="/assets/js/51.33d32c71.js"><link rel="prefetch" href="/assets/js/52.6f3c47c7.js"><link rel="prefetch" href="/assets/js/53.57b773d5.js"><link rel="prefetch" href="/assets/js/54.0437e35c.js"><link rel="prefetch" href="/assets/js/55.33657ea1.js"><link rel="prefetch" href="/assets/js/56.81fa3c75.js"><link rel="prefetch" href="/assets/js/57.195e8d95.js"><link rel="prefetch" href="/assets/js/58.a0082d65.js"><link rel="prefetch" href="/assets/js/59.59349f31.js"><link rel="prefetch" href="/assets/js/60.3b426f4e.js"><link rel="prefetch" href="/assets/js/61.f20aa314.js"><link rel="prefetch" href="/assets/js/62.c6c0ac61.js"><link rel="prefetch" href="/assets/js/63.5a277c2e.js"><link rel="prefetch" href="/assets/js/64.f7df860b.js"><link rel="prefetch" href="/assets/js/65.38cc88cb.js"><link rel="prefetch" href="/assets/js/66.30b92094.js"><link rel="prefetch" href="/assets/js/67.79799a66.js"><link rel="prefetch" href="/assets/js/68.2cadcce1.js"><link rel="prefetch" href="/assets/js/69.4f1ea3ad.js"><link rel="prefetch" href="/assets/js/70.8e3c575d.js"><link rel="prefetch" href="/assets/js/71.bfd02c7e.js"><link rel="prefetch" href="/assets/js/72.a52d3a2c.js"><link rel="prefetch" href="/assets/js/73.c5c52cfe.js"><link rel="prefetch" href="/assets/js/74.b84a9a4d.js"><link rel="prefetch" href="/assets/js/75.b7d7e41d.js"><link rel="prefetch" href="/assets/js/76.a3ff3151.js"><link rel="prefetch" href="/assets/js/77.9bc789b7.js"><link rel="prefetch" href="/assets/js/78.3dafd143.js"><link rel="prefetch" href="/assets/js/80.43259302.js"><link rel="prefetch" href="/assets/js/81.1c815beb.js"><link rel="prefetch" href="/assets/js/82.e1b18d22.js"><link rel="prefetch" href="/assets/js/83.489b306c.js"><link rel="prefetch" href="/assets/js/84.8d777607.js"><link rel="prefetch" href="/assets/js/86.b0a9be3e.js"><link rel="prefetch" href="/assets/js/87.e8d38dd7.js"><link rel="prefetch" href="/assets/js/88.36f643e9.js"><link rel="prefetch" href="/assets/js/89.4bd47103.js"><link rel="prefetch" href="/assets/js/90.f43a13b4.js"><link rel="prefetch" href="/assets/js/91.1b4cc55b.js"><link rel="prefetch" href="/assets/js/92.75396ec1.js"><link rel="prefetch" href="/assets/js/93.9376e7f5.js"><link rel="prefetch" href="/assets/js/94.1f7792b8.js"><link rel="prefetch" href="/assets/js/95.1db8dc92.js"><link rel="prefetch" href="/assets/js/96.e983681a.js"><link rel="prefetch" href="/assets/js/97.3e18769a.js"><link rel="prefetch" href="/assets/js/98.1c64c805.js"><link rel="prefetch" href="/assets/js/99.1404c2c7.js"><link rel="prefetch" href="/assets/js/100.d22d6942.js"><link rel="prefetch" href="/assets/js/101.18066a5f.js"><link rel="prefetch" href="/assets/js/102.3a76998d.js"><link rel="prefetch" href="/assets/js/103.f0b17271.js"><link rel="prefetch" href="/assets/js/104.b8e67d03.js"><link rel="prefetch" href="/assets/js/105.ff873bd8.js"><link rel="prefetch" href="/assets/js/106.4d912bb0.js"><link rel="prefetch" href="/assets/js/107.be364bc5.js"><link rel="prefetch" href="/assets/js/108.c574492c.js"><link rel="prefetch" href="/assets/js/109.8dad8309.js"><link rel="prefetch" href="/assets/js/110.4338edbc.js"><link rel="prefetch" href="/assets/js/111.78923cd4.js"><link rel="prefetch" href="/assets/js/112.d5c9e7b0.js"><link rel="prefetch" href="/assets/js/113.75d3411f.js"><link rel="prefetch" href="/assets/js/114.5428d03c.js"><link rel="prefetch" href="/assets/js/115.f0cb32ca.js"><link rel="prefetch" href="/assets/js/116.396d5bf6.js"><link rel="prefetch" href="/assets/js/117.eba8ac2e.js"><link rel="prefetch" href="/assets/js/118.80949d16.js"><link rel="prefetch" href="/assets/js/119.374fb448.js"><link rel="prefetch" href="/assets/js/120.9a2042d2.js"><link rel="prefetch" href="/assets/js/121.370ff5ae.js"><link rel="prefetch" href="/assets/js/122.4ff25e3d.js"><link rel="prefetch" href="/assets/js/123.b3408294.js"><link rel="prefetch" href="/assets/js/124.f49ebfb6.js"><link rel="prefetch" href="/assets/js/125.c59f8dff.js"><link rel="prefetch" href="/assets/js/126.af0282c9.js"><link rel="prefetch" href="/assets/js/127.472fbe60.js"><link rel="prefetch" href="/assets/js/128.10a68733.js"><link rel="prefetch" href="/assets/js/129.9332cc80.js"><link rel="prefetch" href="/assets/js/130.89cdea63.js"><link rel="prefetch" href="/assets/js/131.14d905e7.js"><link rel="prefetch" href="/assets/js/132.0c623eb3.js"><link rel="prefetch" href="/assets/js/133.7b0d8ae6.js"><link rel="prefetch" href="/assets/js/134.231d2491.js"><link rel="prefetch" href="/assets/js/135.40cdb4e8.js"><link rel="prefetch" href="/assets/js/136.1d3e715a.js"><link rel="prefetch" href="/assets/js/137.49bbc17c.js"><link rel="prefetch" href="/assets/js/138.c5169e24.js"><link rel="prefetch" href="/assets/js/139.054b69b7.js"><link rel="prefetch" href="/assets/js/140.8dbbb57f.js"><link rel="prefetch" href="/assets/js/141.6e65a485.js"><link rel="prefetch" href="/assets/js/142.9bad7827.js"><link rel="prefetch" href="/assets/js/143.e3225628.js"><link rel="prefetch" href="/assets/js/144.5a85983c.js"><link rel="prefetch" href="/assets/js/145.0f87905c.js"><link rel="prefetch" href="/assets/js/146.c1756e66.js"><link rel="prefetch" href="/assets/js/147.cbf7d45e.js"><link rel="prefetch" href="/assets/js/148.e89580bb.js"><link rel="prefetch" href="/assets/js/149.7ac5a7fe.js"><link rel="prefetch" href="/assets/js/150.c4557cdb.js"><link rel="prefetch" href="/assets/js/151.8c90de9b.js"><link rel="prefetch" href="/assets/js/152.688914d9.js"><link rel="prefetch" href="/assets/js/153.570638d0.js"><link rel="prefetch" href="/assets/js/154.4b875c34.js"><link rel="prefetch" href="/assets/js/155.22dfc4b6.js"><link rel="prefetch" href="/assets/js/156.a3dc9edf.js"><link rel="prefetch" href="/assets/js/157.e2857678.js"><link rel="prefetch" href="/assets/js/158.d6f09397.js"><link rel="prefetch" href="/assets/js/159.78267aec.js"><link rel="prefetch" href="/assets/js/160.dc9b9485.js"><link rel="prefetch" href="/assets/js/161.775aa36b.js"><link rel="prefetch" href="/assets/js/162.c706b76e.js"><link rel="prefetch" href="/assets/js/163.7d8cf635.js"><link rel="prefetch" href="/assets/js/164.8ac3abd7.js"><link rel="prefetch" href="/assets/js/165.17b3cd24.js"><link rel="prefetch" href="/assets/js/166.bfa3e920.js"><link rel="prefetch" href="/assets/js/167.32f026e7.js"><link rel="prefetch" href="/assets/js/168.aa92157f.js"><link rel="prefetch" href="/assets/js/169.f9af9f69.js"><link rel="prefetch" href="/assets/js/170.d4672036.js"><link rel="prefetch" href="/assets/js/171.6aa5c7ea.js"><link rel="prefetch" href="/assets/js/172.cf2f2f2f.js"><link rel="prefetch" href="/assets/js/173.5f148dab.js"><link rel="prefetch" href="/assets/js/174.1a8520d1.js"><link rel="prefetch" href="/assets/js/175.5d32257e.js"><link rel="prefetch" href="/assets/js/176.6821d125.js"><link rel="prefetch" href="/assets/js/177.90a5e6af.js"><link rel="prefetch" href="/assets/js/178.c8fd37fe.js"><link rel="prefetch" href="/assets/js/179.4089ebb4.js"><link rel="prefetch" href="/assets/js/180.f69436b6.js"><link rel="prefetch" href="/assets/js/181.26c35c46.js"><link rel="prefetch" href="/assets/js/182.0b7681ef.js"><link rel="prefetch" href="/assets/js/183.12ffe68f.js"><link rel="prefetch" href="/assets/js/184.cb83e8bb.js">
    <link rel="stylesheet" href="/assets/css/185.styles.15a58fe7.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/" class="home-link router-link-active"><!----><span class="site-name">
      思维发散
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><!----></div></header><div class="sidebar-mask"></div><div class="sidebar"><!----><ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading"><span>基础</span><!----></p><ul class="sidebar-group-items"><li><a href="/basis/dataType.html" class="sidebar-link">数据类型</a></li><li><a href="/basis/code-literacy.html" class="sidebar-link">代码素养</a></li><li><a href="/basis/fav-link.html" class="sidebar-link">收藏文章</a></li><li><a href="/basis/fav-blog.html" class="sidebar-link">JS干货</a></li><li><a href="/basis/js-knotty.html" class="sidebar-link">JS疑难知识点</a></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>高级</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>手写代码</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>原理</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>css</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>浏览器</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>组件封装</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>项目经验</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>react</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>vue</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>nodejs</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>webpack</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading open"><span>性能优化</span><span class="arrow down"></span></p><ul class="sidebar-group-items"><li><a href="/optimization/home.html" class="sidebar-link">首屏优化</a></li><li><a href="/optimization/performance.html" class="sidebar-link">performance统计</a></li><li><a href="/optimization/react-optimize-tx.html" class="sidebar-link">react16 性能优化</a></li><li><a href="/optimization/base64.html" class="sidebar-link">图片Base64编码的利与弊分析</a></li><li><a href="/optimization/webpack-splitChunks.html" class="sidebar-link">webpack 业务-公共组件-基础组件</a></li><li><a href="/optimization/etag.html" class="sidebar-link">ETag优化</a></li><li><a href="/optimization/cdn.html" class="sidebar-link">cdn网络加速</a></li><li><a href="/optimization/dns-prefetch.html" class="sidebar-link">DNS预解析</a></li><li><a href="/optimization/common.html" class="sidebar-link">优化策略</a></li><li><a href="/optimization/much-domain.html" class="sidebar-link">多域名静态资源</a></li><li><a href="/optimization/cookie.html" class="sidebar-link">cookie优化</a></li><li><a href="/optimization/css-block.html" class="sidebar-link">css阻塞渲染</a></li><li><a href="/optimization/js-block.html" class="sidebar-link">js阻塞页面渲染</a></li><li><a href="/optimization/js-common.html" class="active sidebar-link">js优化总结</a></li><li><a href="/optimization/reflow-repaint.html" class="sidebar-link">重排重绘</a></li><li><a href="/optimization/webpack.html" class="sidebar-link">webpack 优化</a></li><li><a href="/xiaoce/youhua-webpack.html" class="sidebar-link">webpack性能调优</a></li><li><a href="/xiaoce/youhua-brower.html" class="sidebar-link">浏览器核心</a></li><li><a href="/xiaoce/youhua-image.html" class="sidebar-link">图片优化</a></li><li><a href="/xiaoce/youhua-cache.html" class="sidebar-link">浏览器缓存优化</a></li><li><a href="/xiaoce/youhua-dom.html" class="sidebar-link">DOM优化</a></li><li><a href="/xiaoce/youhua-repaint-flow.html" class="sidebar-link">重绘回流</a></li><li><a href="/xiaoce/youhua-ssr.html" class="sidebar-link">服务端渲染</a></li><li><a href="/xiaoce/youhua-cdn.html" class="sidebar-link">cdn缓存和回援机制</a></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>web安全</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>算法</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>协作</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>后端</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>M</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>练习</span><span class="arrow right"></span></p><!----></div></li></ul></div><div class="page"><div class="content"><h2 id="js优化总结"><a href="#js优化总结" aria-hidden="true" class="header-anchor">#</a> js优化总结</h2><h3 id="对多个条件使用-array-includes"><a href="#对多个条件使用-array-includes" aria-hidden="true" class="header-anchor">#</a> 对多个条件使用 Array.includes</h3><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// bad</span>
<span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span>fruit<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>fruit <span class="token operator">==</span> <span class="token string">'apple'</span> <span class="token operator">||</span> fruit <span class="token operator">==</span> <span class="token string">'strawberry'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'red'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// good</span>
<span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span>fruit<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> redFruits <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'apple'</span><span class="token punctuation">,</span> <span class="token string">'strawberry'</span><span class="token punctuation">,</span> <span class="token string">'cherry'</span><span class="token punctuation">,</span> <span class="token string">'cranberries'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>redFruits<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>fruit<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'red'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h3 id="更少的嵌套，尽早返回"><a href="#更少的嵌套，尽早返回" aria-hidden="true" class="header-anchor">#</a> 更少的嵌套，尽早返回</h3><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span>fruit<span class="token punctuation">,</span> quantity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> redFruits <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'apple'</span><span class="token punctuation">,</span> <span class="token string">'strawberry'</span><span class="token punctuation">,</span> <span class="token string">'cherry'</span><span class="token punctuation">,</span> <span class="token string">'cranberries'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
 
  <span class="token comment">// condition 1: throw error early</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>fruit<span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'No fruit!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  <span class="token comment">// condition 2: must be red</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>redFruits<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>fruit<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'red'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
    <span class="token comment">// condition 3: must be big quantity</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>quantity <span class="token operator">&amp;</span>gt<span class="token punctuation">;</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'big quantity'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// =========&gt; good</span>
<span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span>fruit<span class="token punctuation">,</span> quantity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> redFruits <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'apple'</span><span class="token punctuation">,</span> <span class="token string">'strawberry'</span><span class="token punctuation">,</span> <span class="token string">'cherry'</span><span class="token punctuation">,</span> <span class="token string">'cranberries'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
 
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>fruit<span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'No fruit!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// condition 1: throw error early</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>redFruits<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>fruit<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span> <span class="token comment">// condition 2: stop when fruit is not red</span>
 
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'red'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  <span class="token comment">// condition 3: must be big quantity</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>quantity <span class="token operator">&amp;</span>gt<span class="token punctuation">;</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'big quantity'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="使用默认的函数参数和解构"><a href="#使用默认的函数参数和解构" aria-hidden="true" class="header-anchor">#</a> 使用默认的函数参数和解构</h3><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span>fruit<span class="token punctuation">,</span> quantity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>fruit<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> q <span class="token operator">=</span> quantity <span class="token operator">||</span> <span class="token number">1</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`We have </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>q<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>fruit<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">!`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'banana'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// We have 1 banana!</span>
<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'apple'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// We have 2 apple!</span>
<span class="token comment">// =========&gt; good</span>
<span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span>fruit<span class="token punctuation">,</span> quantity <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>fruit<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`We have </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>quantity<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>fruit<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">!`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'banana'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// We have 1 banana!</span>
<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'apple'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// We have 2 apple!</span>
</code></pre></div><h3 id="选择-map-或对象字面量，而不是-switch-语句"><a href="#选择-map-或对象字面量，而不是-switch-语句" aria-hidden="true" class="header-anchor">#</a> 选择 Map 或对象字面量，而不是 Switch 语句</h3><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span>color<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>color<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token string">'red'</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token string">'apple'</span><span class="token punctuation">,</span> <span class="token string">'strawberry'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token string">'yellow'</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token string">'banana'</span><span class="token punctuation">,</span> <span class="token string">'pineapple'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token string">'purple'</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token string">'grape'</span><span class="token punctuation">,</span> <span class="token string">'plum'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">test</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// []</span>
<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'yellow'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ['banana', 'pineapple']</span>
<span class="token comment">// =========&gt; good</span>
<span class="token keyword">const</span> fruitColor <span class="token operator">=</span> <span class="token punctuation">{</span>
  red<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'apple'</span><span class="token punctuation">,</span> <span class="token string">'strawberry'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  yellow<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'banana'</span><span class="token punctuation">,</span> <span class="token string">'pineapple'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  purple<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'grape'</span><span class="token punctuation">,</span> <span class="token string">'plum'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
 
<span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span>color<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> fruitColor<span class="token punctuation">[</span>color<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// or</span>
<span class="token keyword">const</span> fruitColor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token string">'red'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'apple'</span><span class="token punctuation">,</span> <span class="token string">'strawberry'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token string">'yellow'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'banana'</span><span class="token punctuation">,</span> <span class="token string">'pineapple'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token string">'purple'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'grape'</span><span class="token punctuation">,</span> <span class="token string">'plum'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span>color<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> fruitColor<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span>color<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>###避免全局变量
在一个函数中会用到全局对象存储为局部变量来减少全局查找，因为访问局部变量的速度要比访问全局变量的速度更快些。</p><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">search</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//当我要使用当前页面地址和主机域名</span>
  <span class="token function">alert</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href <span class="token operator">+</span> window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>host<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//最好的方式是如下这样  先用一个简单变量保存起来</span>
<span class="token keyword">function</span> <span class="token function">search</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> location <span class="token operator">=</span> window<span class="token punctuation">.</span>location<span class="token punctuation">;</span>
  ……
<span class="token punctuation">}</span>
</code></pre></div><h3 id="定时器"><a href="#定时器" aria-hidden="true" class="header-anchor">#</a> 定时器</h3><p>如果针对的是不断运行的代码，不应该使用setTimeout，而应该是用setInterval，因为setTimeout每一次都会初始化一个定时器，而setInterval只会在开始的时候初始化一个定时器。</p><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> timeoutTimes <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">timeout</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  timeoutTimes<span class="token operator">++</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>timeoutTimes <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span>timeout<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">timeout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//可以替换为：</span>
<span class="token keyword">var</span> intervalTimes <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">interval</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  intervalTimes<span class="token operator">++</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>intervalTimes <span class="token operator">&gt;=</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">clearInterval</span><span class="token punctuation">(</span>interv<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> interv <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span>interval<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="字符串连接"><a href="#字符串连接" aria-hidden="true" class="header-anchor">#</a> 字符串连接</h3><p>如果要连接多个字符串，应该少使用+=，如</p><div class="language-js extra-class"><pre class="language-js"><code>s<span class="token operator">+=</span>a<span class="token punctuation">;</span>
s<span class="token operator">+=</span>b<span class="token punctuation">;</span>
s<span class="token operator">+=</span>c<span class="token punctuation">;</span>
<span class="token comment">//应该写成</span>
s<span class="token operator">+=</span>a <span class="token operator">+</span> b <span class="token operator">+</span> c；

</code></pre></div><p>而如果是收集字符串，比如多次对同一个字符串进行+=操作的话，最好使用一个缓存，使用JavaScript数组来收集，最后使用join方法连接起来</p><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> buf <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  buf<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>i<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> all <span class="token operator">=</span> buf<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token template-string"><span class="token string">``</span></span>
### 避免<span class="token keyword">with</span>
和函数类似 ，<span class="token keyword">with</span>语句会创建自己的作用域，因此会增加其中执行的代码的作用域链的长度，由于额外的作用域链的查找，在<span class="token keyword">with</span>语句中执行的代码肯定会比外面执行的代码要慢，在能不使用<span class="token keyword">with</span>语句的时候尽量不要使用<span class="token keyword">with</span>语句
<span class="token template-string"><span class="token string">``</span></span>`js
<span class="token keyword">with</span> <span class="token punctuation">(</span>a<span class="token punctuation">.</span>b<span class="token punctuation">.</span>c<span class="token punctuation">.</span>d<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    property1 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    property2 <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//可以替换为：</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> a<span class="token punctuation">.</span>b<span class="token punctuation">.</span>c<span class="token punctuation">.</span>d<span class="token punctuation">;</span>
obj<span class="token punctuation">.</span>property1 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
obj<span class="token punctuation">.</span>property2 <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="数字转字符串"><a href="#数字转字符串" aria-hidden="true" class="header-anchor">#</a> 数字转字符串</h3><p>一般最好用&quot;&quot; + 1来将数字转换成字符串，虽然看起来比较丑一点，但事实上这个效率是最高的，性能上来说：</p><p><code>(&quot;&quot; +) &gt; String() &gt; .toString() &gt; new String()</code></p><p>如果定义了toString()方法来进行类型转换的话，推荐显式调用toString()，因为内部的操作在尝试所有可能性之后，会尝试对象的toString()方法尝试能否转化为String，所以直接调用这个方法效率会更高</p><h3 id="浮点转整型"><a href="#浮点转整型" aria-hidden="true" class="header-anchor">#</a> 浮点转整型</h3><p>很多人喜欢使用parseInt()，其实parseInt()是用于将字符串转换成数字，而不是浮点数和整型之间的转换，我们应该使用Math.floor()或者Math.round()</p><h3 id="多个类型声明，使用单var"><a href="#多个类型声明，使用单var" aria-hidden="true" class="header-anchor">#</a> 多个类型声明，使用单var</h3><p>在JavaScript中所有变量都可以使用单个var语句来声明，这样就是组合在一起的语句，以减少整个脚本的执行时间，就如上面代码一样，上面代码格式也挺规范，让人一看就明了。</p><div class="language-js extra-class"><pre class="language-js"><code> <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
 <span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
 <span class="token comment">// 替换成</span>
 <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
     b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>

</code></pre></div><h3 id="插入迭代器"><a href="#插入迭代器" aria-hidden="true" class="header-anchor">#</a> 插入迭代器</h3><p>如var name=values[i]; i++;前面两条语句可以写成var name=values[i++]。（原理在于i++是先赋值，再自加）</p><h3 id="使用直接量"><a href="#使用直接量" aria-hidden="true" class="header-anchor">#</a> 使用直接量</h3><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> aTest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//替换为</span>
<span class="token keyword">var</span> aTest <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> aTest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">;</span> <span class="token comment">//替换为</span>
<span class="token keyword">var</span> aTest <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> reg <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//替换为</span>
<span class="token keyword">var</span> reg <span class="token operator">=</span> <span class="token regex">/../</span><span class="token punctuation">;</span>

<span class="token comment">//如果要创建具有一些特性的一般对象，也可以使用字面量，如下：</span>
<span class="token keyword">var</span> oFruit <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">O</span><span class="token punctuation">;</span>
oFruit<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">&quot;red&quot;</span><span class="token punctuation">;</span>
oFruit<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;apple&quot;</span><span class="token punctuation">;</span>
<span class="token comment">//前面的代码可用对象字面量来改写成这样：</span>
<span class="token keyword">var</span> oFruit <span class="token operator">=</span> <span class="token punctuation">{</span> color<span class="token punctuation">:</span> <span class="token string">&quot;red&quot;</span><span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token string">&quot;apple&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="使用documentfragment优化多次append"><a href="#使用documentfragment优化多次append" aria-hidden="true" class="header-anchor">#</a> 使用DocumentFragment优化多次append</h3><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">1000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> el <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement_x</span><span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  el<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> i<span class="token punctuation">;</span>
  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//可以替换为：</span>
<span class="token keyword">var</span> frag <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createDocumentFragment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">1000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> el <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement_x</span><span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  el<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> i<span class="token punctuation">;</span>
  frag<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>frag<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="使用一次innerhtml赋值代替构建dom元素"><a href="#使用一次innerhtml赋值代替构建dom元素" aria-hidden="true" class="header-anchor">#</a> 使用一次innerHTML赋值代替构建dom元素</h3><p>对于大的DOM更改，使用innerHTML要比使用标准的DOM方法创建同样的DOM结构快得多。</p><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> frag <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createDocumentFragment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">1000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> el <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement_x</span><span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  el<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> i<span class="token punctuation">;</span>
  frag<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>frag<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//可以替换为：</span>
<span class="token keyword">var</span> html <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">1000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  html<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">' '</span> <span class="token operator">+</span> i <span class="token operator">+</span> <span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> html<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="使用firstchild和nextsibling代替childnodes遍历dom元素"><a href="#使用firstchild和nextsibling代替childnodes遍历dom元素" aria-hidden="true" class="header-anchor">#</a> 使用firstChild和nextSibling代替childNodes遍历dom元素</h3><p>很多人喜欢在JavaScript中使用document.write来给页面生成内容。事实上这样的效率较低，如果需要直接插入HTML，可以找一个容器元素，比如指定一个div或者span，并设置他们的innerHTML来将自己的HTML代码插入到页面中。通常我们可能会使用字符串直接写HTML来创建节点，其实这样做，1、无法保证代码的有效性；2、字符串操作效率低，所以应该是用document.createElement_x()方法，而如果文档中存在现成的样板节点，应该用cloneNode()方法，因为使用createElement_x()方法之后，你需要设置多次元素的属性，使用cloneNode()则可以减少属性的设置次数——同样如果需要创建很多元素，应该先准备一个样板节点。</p><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> frag <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createDocumentFragment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">1000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">var</span> el <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement_x</span><span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   el<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> i<span class="token punctuation">;</span>
   frag<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>frag<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//替换为：</span>
<span class="token keyword">var</span> frag <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createDocumentFragment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> pEl <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName_r</span><span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">1000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">var</span> el <span class="token operator">=</span> pEl<span class="token punctuation">.</span><span class="token function">cloneNode</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   el<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> i<span class="token punctuation">;</span>
   frag<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>frag<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="删除dom节点"><a href="#删除dom节点" aria-hidden="true" class="header-anchor">#</a> 删除DOM节点</h3><p>删除dom节点之前，一定要删除注册在该节点上的事件，不管是用observe方式还是用attachEvent方式注册的事件，否则将会产生无法回收的内存。另外，在removeChild和innerHTML=&quot;&quot;二者之间，尽量选择后者。因为在sIEve(内存泄露监测工具)中监测的结果是用removeChild无法有效地释放dom节点。</p><h3 id="使用事件代理"><a href="#使用事件代理" aria-hidden="true" class="header-anchor">#</a> 使用事件代理</h3><p>任何可以冒泡的事件都不仅仅可以在事件目标上进行处理，目标的任何祖先节点上也能处理，使用这个知识就可以将事件处理程序附加到更高的地方负责多个目标的事件处理，同样，对于内容动态增加并且子节点都需要相同的事件处理函数的情况，可以把事件注册提到父节点上，这样就不需要为每个子节点注册事件监听了。另外，现有的js库都采用observe方式来创建事件监听。其实现上隔离了dom对象和事件处理函数之间的循环引用，所以应该尽量采用这种方式来创建事件监听。</p><h3 id="重复使用的调用结果，事先保存到局部变量"><a href="#重复使用的调用结果，事先保存到局部变量" aria-hidden="true" class="header-anchor">#</a> 重复使用的调用结果，事先保存到局部变量</h3><p>避免多次取值的调用开销</p><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//避免多次取值的调用开销</span>
 <span class="token keyword">var</span> h1 <span class="token operator">=</span> element1<span class="token punctuation">.</span>clientHeight <span class="token operator">+</span> num1<span class="token punctuation">;</span>
 <span class="token keyword">var</span> h2 <span class="token operator">=</span> element1<span class="token punctuation">.</span>clientHeight <span class="token operator">+</span> num2<span class="token punctuation">;</span>

 <span class="token comment">//可以替换为：</span>
 <span class="token keyword">var</span> eleHeight <span class="token operator">=</span> element1<span class="token punctuation">.</span>clientHeight<span class="token punctuation">;</span>
 <span class="token keyword">var</span> h1 <span class="token operator">=</span> eleHeight <span class="token operator">+</span> num1<span class="token punctuation">;</span>
 <span class="token keyword">var</span> h2 <span class="token operator">=</span> eleHeight <span class="token operator">+</span> num2<span class="token punctuation">;</span>
</code></pre></div><h3 id="注意nodelist"><a href="#注意nodelist" aria-hidden="true" class="header-anchor">#</a> 注意NodeList</h3><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> images <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName_r</span><span class="token punctuation">(</span><span class="token string">'img'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> len <span class="token operator">=</span> images<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre></div><p>最小化访问NodeList的次数可以极大的改进脚本的性能
编写JavaScript的时候一定要知道何时返回NodeList对象，这样可以最小化对它们的访问</p><p>进行了对getElementsByTagName_r()的调用
获取了元素的childNodes属性
获取了元素的attributes属性
访问了特殊的集合，如document.forms、document.images等等
　　要了解了当使用NodeList对象时，合理使用会极大的提升代码执行速度。</p><h3 id="优化循环"><a href="#优化循环" aria-hidden="true" class="header-anchor">#</a> 优化循环</h3><p>可以使用下面几种方式来优化循环</p><p>1、减值迭代</p><p>大多数循环使用一个从0开始、增加到某个特定值的迭代器，在很多情况下，从最大值开始，在循环中不断减值的迭代器更加高效</p><p>2、简化终止条件</p><p>由于每次循环过程都会计算终止条件，所以必须保证它尽可能快，也就是说避免属性查找或者其它的操作，最好是将循环控制量保存到局部变量中，也就是说对数组或列表对象的遍历时，提前将length保存到局部变量中，避免在循环的每一步重复取值。</p><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> list <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName_r</span><span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> list<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token comment">//……</span>
<span class="token punctuation">}</span>

<span class="token comment">//替换为：</span>
<span class="token keyword">var</span> list <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName_r</span><span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> l <span class="token operator">=</span> list<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> l<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token comment">//……</span>
<span class="token punctuation">}</span>
</code></pre></div><p>3、简化循环体</p><p>循环体是执行最多的，所以要确保其被最大限度的优化</p><p>4、使用后测试循环</p><p>在JavaScript中，我们可以使用for(;😉,while(),for(in)三种循环，事实上，这三种循环中for(in)的效率极差，因为他需要查询散列键，只要可以，就应该尽量少用。for(;;)和while循环，while循环的效率要优于for(;😉，可能是因为for(;;)结构的问题，需要经常跳转回去。</p><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> l <span class="token operator">=</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> l<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   sum <span class="token operator">+=</span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//可以考虑替换为：</span>
<span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> l <span class="token operator">=</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
<span class="token keyword">while</span> <span class="token punctuation">(</span>l<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    sum <span class="token operator">+=</span> arr<span class="token punctuation">[</span>l<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>最常用的for循环和while循环都是前测试循环，而如do-while这种后测试循环，可以避免最初终止条件的计算，因此运行更快。</p><h3 id="展开循环"><a href="#展开循环" aria-hidden="true" class="header-anchor">#</a> 展开循环</h3><p>当循环次数是确定的，消除循环并使用多次函数调用往往会更快。</p><p>避免双重解释：如果要提高代码性能，尽可能避免出现需要按照JavaScript解释的字符串，也就是</p><p>1、尽量少使用eval函数：使用eval相当于在运行时再次调用解释引擎对内容进行运行，需要消耗大量时间，而且使用Eval带来的安全性问题也是不容忽视的。</p><p>2、不要使用Function构造器</p><p>3、不要给setTimeout或者setInterval传递字符串参数</p><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> num <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token string">'num++'</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//可以替换为：</span>
<span class="token keyword">var</span> num <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">addNum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  num<span class="token operator">++</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span>addNum<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="条件分支"><a href="#条件分支" aria-hidden="true" class="header-anchor">#</a> 条件分支</h3><p>将条件分支，按可能性顺序从高到低排列：可以减少解释器对条件的探测次数</p><p>在同一条件子的多（&gt;2）条件分支时，使用switch优于if：switch分支选择的效率高于if，在IE下尤为明显。4分支的测试，IE下switch的执行时间约为if的一半。</p><p>使用三目运算符替代条件分支</p><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token operator">&gt;</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
     num <span class="token operator">=</span> a<span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
     num <span class="token operator">=</span> b<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//可以替换为：</span>
num <span class="token operator">=</span> a <span class="token operator">&gt;</span> b <span class="token operator">?</span> a <span class="token punctuation">:</span> b<span class="token punctuation">;</span>
</code></pre></div></div><div class="content edit-link"><!----><!----></div><div class="content page-nav"><p class="inner"><span class="prev">
        ← <a href="/optimization/js-block.html" class="prev">
          js阻塞页面渲染
        </a></span><span class="next"><a href="/optimization/reflow-repaint.html">
          重排重绘
        </a> →
      </span></p></div></div></div></div>
    <script src="/assets/js/79.a472ce98.js" defer></script><script src="/assets/js/app.6f74513f.js" defer></script>
  </body>
</html>
